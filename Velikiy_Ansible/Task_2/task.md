# üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥—É–ª—è Ansible –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç–æ–º nginx

**–í—ã–ø–æ–ª–Ω–∏–ª:** –¢–æ–≤–ø–µ–∫–æ –ì–ª–µ–± –í–∞–¥–∏–º–æ–≤–∏—á, –≥—Ä—É–ø–ø–∞ K0109-23

# –§–æ—Ç–æ —Ä–∞–±–æ—á–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è (–ø–æ—Å–ª–µ –Ω–∏—Ö –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ :(( ):
<img width="720" height="880" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/b1a2463a-f291-4d37-af90-b64b807eeda5" />

<img width="788" height="574" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/7739a4ce-2ab9-4cf3-9396-5c0c12d26df1" />

<img width="604" height="513" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/d85e497d-46e5-4e6d-84ae-aebfa4a7140b" />

<img width="977" height="130" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/19fed545-5602-4977-beab-90189086170f" />

<img width="788" height="297" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/a2e2cbe1-e5c8-46c4-bcf2-cc176bb9c2d7" />

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è](#-–æ–ø–∏—Å–∞–Ω–∏–µ-–∑–∞–¥–∞–Ω–∏—è)
2. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](#-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
6. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É](#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–ø–æ-–∑–∞–ø—É—Å–∫—É)
9. [–ó–∞–∫–ª—é—á–µ–Ω–∏–µ](#-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ)

---

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è

> **–ù–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –º–æ–¥—É–ª—å Ansible, –∫–æ—Ç–æ—Ä—ã–π:**
> * –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ—Ä—Ç –¥–ª—è nginx
> * –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ **nginx**. –ú–æ–¥—É–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–æ–≤—ã–π –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤–æ –≤—Å–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã `listen` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:** –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å Ansible –Ω–∞ Python, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–µ–∂–∏–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏.

---

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥—É–ª—è Ansible –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è **Python** —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ **`AnsibleModule`** –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `ansible.module_utils.basic`, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Ansible –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

–í –º–æ–¥—É–ª–µ –±—ã–ª–∏ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- **`os`** ‚Äî –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
- **`re`** ‚Äî –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∏ –∑–∞–º–µ–Ω–µ –ø–æ—Ä—Ç–æ–≤ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª—è:

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `check_mode` | –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| ‚úÖ `argument_spec` | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø–æ—Ä—Ç –∏ –ø—É—Ç—å –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏) |
| ‚úÖ –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ | –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º nginx |
| ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ |
| ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è | –ü–æ–∏—Å–∫ –∏ –∑–∞–º–µ–Ω–∞ –ø–æ—Ä—Ç–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö |

### –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∏—Ä–µ–∫—Ç–∏–≤—ã `listen`:

–ú–æ–¥—É–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∑–∞–ø–∏—Å–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã `listen` –≤ nginx:

```nginx
# –§–æ—Ä–º–∞—Ç —Å IP-–∞–¥—Ä–µ—Å–æ–º
listen 10.23.68.202:80;
listen 10.23.68.202:80 default_server;

# –§–æ—Ä–º–∞—Ç —Å localhost
listen 127.0.0.1:80;
listen localhost:80;

# –ü—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–∞—Ç
listen 80;
listen 80 default_server;
listen 80 ssl;
listen 80 http2;

# IPv6 —Ñ–æ—Ä–º–∞—Ç
listen [::]:80;
listen [::]:80 default_server;
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Task_2/
‚îú‚îÄ‚îÄ üìÇ library/
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ nginx_port.py          # –ú–æ–¥—É–ª—å Ansible
‚îú‚îÄ‚îÄ üìÑ main.yml                    # –ü–ª–µ–π–±—É–∫ –¥–ª—è –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ üìÑ inventory.ini              # –§–∞–π–ª –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
‚îî‚îÄ‚îÄ üìÑ ansible.cfg                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ansible (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```
## –§–∞–π–ª –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è (inventory.ini)

```
[my_nginx]
local-nginx ansible_host=127.0.0.1 ansible_user=urahoy
```

## üöÄ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

```
–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ	–ü—Ä–æ–≤–µ—Ä–∫–∞
‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Ansible	ansible --version
‚úÖ –ü—Ä–∞–≤–∞ sudo	sudo -v
‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω nginx	nginx -v
```

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```
ansible-playbook -i inventory.ini main.yml --check -v (–≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –∑–∞–¥–∞–Ω–∏–µ–º)
```

### –†–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –º–æ–¥—É–ª—è:
```
ansible-playbook -i inventory.ini main.yml --ask-become-pass -v (–≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –∑–∞–¥–∞–Ω–∏–µ–º)
```

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –º–æ–¥—É–ª—å Ansible –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç–æ–º nginx.
